!function($){"use strict";var e=$(".magic8 input, input.magic8");e.each(function(){function e(){t.each(function(){var e=$(this).text().toLowerCase(),a=s.val().toLowerCase();0===e.indexOf(a)?$(this).addClass("show"):$(this).removeClass("show")})}function a(){var e=!1;t.each(function(){var a=$(this).text().toLowerCase(),o=s.val().toLowerCase();a===o&&(e=!0)}),e?s.trigger("magic8-match",[s,o]):s.trigger("magic8-no-match",[s,o])}var s=$(this),o=s.parent(),r=o.find("ul.magic8"),t=r.find("li"),n=s.parents(".magic8"),i=n.attr("id");n.removeClass("magic8"),o.addClass("magic8"),s.hasClass("magic8")||s.addClass("magic8"),s.attr("autocomplete","off"),s.on("focus click",function(){o.addClass("open"),r[0]?e():(o.append('<ul class="magic8"></ul>'),r=o.find("ul.magic8"),r.append('<li class="show">Searching...</li>'),$.ajax({url:magic8_ajax_vars.url,type:"POST",dataType:"json",data:{action:"magic8",nonce:magic8_ajax_vars.nonce,name:i},beforeSend:function(e){r.append('<li class="Searching">Searching...</li>')},success:function(e){e.success&&(r.empty(),r.append(e.data.html))},complete:function(r,n){t=o.find("ul.magic8 li"),t.hover(function(){t.removeClass("hovered"),$(this).addClass("hovered")}),t.click("click",function(){s.val($(this).text()),o.removeClass("open"),t.removeClass("hovered"),s.trigger("change"),a()}),e()}}))}),s.focusout(function(){$(t.selector+":hover")[0]||(o.removeClass("open"),t.removeClass("hovered"))}),s.on("keyup paste",function(s){13!==s.keyCode&&27!==s.keyCode&&(o.hasClass("open")||o.addClass("open"),e(),a())}),$(document).keydown(function(e){o.hasClass("open")&&(13===e.keyCode?(t.hasClass("hovered")&&(s.val(t.filter(".hovered").text()),a()),o.removeClass("open"),t.removeClass("hovered"),s.trigger("change"),e.preventDefault()):27===e.keyCode?(o.removeClass("open"),t.removeClass("hovered"),e.preventDefault()):38===e.keyCode?(t.hasClass("hovered")&&t.filter(".hovered").prev(".show")[0]?t.filter(".hovered").removeClass("hovered").prev(".show").addClass("hovered"):(t.filter(".hovered").removeClass("hovered"),t.filter(".show").last().addClass("hovered")),e.preventDefault()):40===e.keyCode&&(t.hasClass("hovered")&&t.filter(".hovered").next(".show")[0]?t.filter(".hovered").removeClass("hovered").next(".show").addClass("hovered"):(t.filter(".hovered").removeClass("hovered"),t.filter(".show").first().addClass("hovered")),e.preventDefault()))})})}(jQuery);